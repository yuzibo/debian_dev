From f042ccc6f2bda11cc7fad587dc075734766f04f3 Mon Sep 17 00:00:00 2001
From: Bo YU <tsu.yubo@gmail.com>
Date: Thu, 23 Mar 2023 06:48:11 +0800
Subject: [PATCH] support riscv64

Signed-off-by: Bo YU <tsu.yubo@gmail.com>
---
 debian/changelog         | 7 +++++++
 debian/control           | 2 +-
 debian/mozconfig.default | 5 +++++
 debian/rules             | 2 ++
 4 files changed, 15 insertions(+), 1 deletion(-)

diff --git a/debian/changelog b/debian/changelog
index 988bedc1c1d..6699d54b4a3 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,10 @@
+thunderbird (1:110.0~b4-1.1) UNRELEASED; urgency=medium
+
+  * Non-maintainer upload.
+  * Support riscv64
+
+ -- Bo YU <tsu.yubo@gmail.com>  Thu, 23 Mar 2023 06:47:28 +0800
+
 thunderbird (1:110.0~b4-1) experimental; urgency=medium
 
 
diff --git a/debian/control b/debian/control
index 232a43e6578..bd0ba9e936e 100644
--- a/debian/control
+++ b/debian/control
@@ -62,7 +62,7 @@ X-Debian-Homepage: http://wiki.debian.org/Thunderbird
 Standards-Version: 4.6.1
 
 Package: thunderbird
-Architecture: amd64 arm64 i386 mips64el ppc64el s390x ppc64
+Architecture: amd64 arm64 i386 mips64el ppc64el s390x ppc64 riscv64
 Depends:
  debianutils (>= 1.16),
  fontconfig,
diff --git a/debian/mozconfig.default b/debian/mozconfig.default
index aff9e4a8bca..551798e9271 100644
--- a/debian/mozconfig.default
+++ b/debian/mozconfig.default
@@ -117,6 +117,11 @@ case `dpkg --print-architecture` in
   ppc64el)
     ac_add_options --with-intl-api
     ;;
+  riscv64)
+    ac_add_options --disable-jit
+    ac_add_options --disable-debug
+    ac_add_options --disable-debug-symbols
+    ;;
   sh4)
     ac_add_options --disable-pie
     ;;
diff --git a/debian/rules b/debian/rules
index 14290f73661..8b0acfee0a3 100755
--- a/debian/rules
+++ b/debian/rules
@@ -67,7 +67,9 @@ LDFLAGS += -Wl,--stats
 # are performing a dist-upgrade to a new release.
 export MOZ_BUILD_DATE := ${shell head -n1 $(CURDIR)/sourcestamp.txt}
 export MOZCONFIG=$(shell pwd)/mozconfig.thunderbird
+ifneq ($(DEB_BUILD_ARCH),riscv64)
 export MOZILLA_OFFICIAL=1
+endif
 export DEB_BUILD_GNU_TYPE
 export DEB_HOST_GNU_TYPE
 export DEB_BUILD_OPTIONS
-- 
2.39.2

